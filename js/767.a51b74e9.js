"use strict";(self["webpackChunkmvtime"]=self["webpackChunkmvtime"]||[]).push([[767],{767:function(e,s,a){a.r(s),a.d(s,{default:function(){return T}});var t=a(3396),i=a(7139),l=a(9242);const o=e=>((0,t.dD)("data-v-31232e9f"),e=e(),(0,t.Cn)(),e),n={class:"createclass"},r=o((()=>(0,t._)("header",{class:"modal_header"},[(0,t._)("h2",{class:"header_style modal_header_title"},"Edit class details")],-1))),c={class:"overlay_contents",ref:"contents"},d={key:0},h={class:"overlay_contents_text"},_={class:"inputs_row"},p={class:"class_period_container styled_obj"},u={class:"color_input_container styled_input",title:"Class Theme Color"},g={key:1,alt:"Loading Icon",class:"loading_icon"},m={class:"bottom_actions"},f=["disabled"],b=o((()=>(0,t._)("div",{class:"flex_spacer"},null,-1))),v=["disabled"],y=["disabled"];function w(e,s,a,o,w,C){return(0,t.wg)(),(0,t.iD)("main",n,[r,(0,t._)("div",c,[w.ready?((0,t.wg)(),(0,t.iD)("div",d,[(0,t._)("div",h,[(0,t.Uk)(" You're editing "),(0,t._)("span",{class:"class_name button_pointer_text",style:(0,i.j5)({"--color-class":w.original.color,"--color-class-alt":w.original.color+"2d"})},(0,i.zw)(`P${w.original.period} - ${w.original.name}`),5)]),(0,t._)("div",_,[(0,t._)("div",p,[(0,t.wy)((0,t._)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>w.class_obj.period=e),class:"styled_input class_period",type:"number",min:"1",max:"8",step:"1",placeholder:"#"},null,512),[[l.nr,w.class_obj.period]])]),(0,t.wy)((0,t._)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>w.class_obj.name=e),class:"styled_input class_name",type:"text",placeholder:"Name"},null,512),[[l.nr,w.class_obj.name]]),(0,t._)("div",u,[(0,t.wy)((0,t._)("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>w.class_obj.color=e),class:"color_input",type:"color",placeholder:"Class Color"},null,512),[[l.nr,w.class_obj.color]])])])])):((0,t.wg)(),(0,t.iD)("img",g))],512),(0,t._)("div",m,[(0,t._)("button",{class:(0,i.C_)(["alt_action",{loading_bg:w.loading_share&&w.ready}]),onClick:s[3]||(s[3]=s=>{w.ready?C.share_class():e.$emit("close")}),disabled:w.ready&&w.loading_share||C.is_owned},(0,i.zw)(w.ready?"Share":"Close"),11,f),b,(0,t._)("button",{class:"leave_action primary_styled",onClick:s[4]||(s[4]=(...e)=>C.leave_class&&C.leave_class(...e)),disabled:!w.ready}," Leave ",8,v),(0,t._)("button",{class:(0,i.C_)(["continue_action",{loading_bg:w.loading}]),onClick:s[5]||(s[5]=(...e)=>C.update_class&&C.update_class(...e)),disabled:!w.ready||!C.changed||!w.class_obj.name||!w.class_obj.period}," Save class ",10,y)])])}a(7658);var C=a(8980),j=a(9529),$=a.n(j),O=a(1708),k=a(2745),x={name:"EditClassView",emits:["close"],mixins:[$()],data(){return{class_obj:{},original:{},loading:!1,ready:!1,ref:this.$route?.params?.ref,loading_share:!1}},computed:{store(){return(0,C.h)()},changed(){return JSON.stringify(this.class_obj)!=JSON.stringify(this.original)},is_owned(){return this.store.user.email.split("@")[0]==this.ref.split("/")[0]}},mounted(){if(this.$smoothReflow({el:this.$refs.contents,childTransitions:!0}),!this.ref||2!=this.ref.split("~").length)return new O.OO("Invalid class provided"),void this.$emit("close");this.ref=this.ref.split("~").join("/"),this.get_class(),this.is_owned||(this.$emit("close"),new O.OO("You are not the teacher of this class",2e3))},methods:{update_class(){this.loading=!0,this.store.update_class(this.ref,this.class_obj).then((()=>{this.$emit("close")})).catch((e=>{new O.OO("Something went wrong updating the class",2500),(0,k.E)("ðŸ”¥Couldn't update class",this.ref,e),this.loading=!1}))},get_class(){this.ready=!1,this.store.class_from_ref(this.ref).then((e=>{this.class_obj=e,this.original={...e},this.ready=!0})).catch((e=>{new O.OO("Couldn't find that class",2e3),(0,k.E)("ðŸ”¥Couldn't find class for edit",this.ref,e),this.$emit("close")}))},leave_class(){this.$router.push({name:"leave",params:{ref:this.$route?.params?.ref}})},async share_class(){this.loading_share=!0,this.store.code_from_ref(this.ref).then((e=>{let s=new URL("https://add.mvtt.app/"+e);navigator.share?navigator.share({title:`P${this.class_obj.period} - ${this.class_obj.name}`,text:"Join my class on MVTT!",url:s.href}).then((()=>new O.bF("Opened share dialog",1e3))).catch((e=>(0,k.E)("Error sharing",e))):navigator.clipboard?(navigator.clipboard.writeText(s.href),new O.OO("Sharing not supported, copied link to clipboard",2e3)):new O.PK("Sharing not supported",2e3),this.loading_share=!1})).catch((e=>{new O.PK("Something went wrong getting the code",e?.message||e,2e3),(0,k.E)("ðŸ”¥Couldn't get code",this.ref,e),this.loading_share=!1}))}}},S=a(89);const E=(0,S.Z)(x,[["render",w],["__scopeId","data-v-31232e9f"]]);var T=E}}]);
//# sourceMappingURL=767.a51b74e9.js.map