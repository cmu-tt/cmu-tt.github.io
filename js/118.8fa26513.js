"use strict";(self["webpackChunkmvtime"]=self["webpackChunkmvtime"]||[]).push([[118],{4118:function(t,e,s){s.r(e),s.d(e,{default:function(){return A}});s(7658);var a=s(3396),i=s(7139),o=s(9242);const n=t=>((0,a.dD)("data-v-2f9f384c"),t=t(),(0,a.Cn)(),t),r={class:"modal_header",ref:"title"},l={class:"header_style modal_header_title"},d={class:"overlay_contents",ref:"contents"},c={key:0},h={class:"overlay_contents_text change_text"},_=["href"],u={class:"inputs_row"},k=["placeholder"],m={key:1,alt:"Loading Icon",class:"loading_icon"},p={class:"bottom_actions"},f=n((()=>(0,a._)("div",{class:"flex_spacer"},null,-1))),g=["disabled"],y=["disabled"];function b(t,e,s,n,b,w){return(0,a.wg)(),(0,a.iD)("div",{class:"edit_task",onKeypress:e[5]||(e[5]=(...t)=>w.submit_key&&w.submit_key(...t))},[(0,a._)("header",r,[(0,a._)("h2",l,(0,i.zw)(b.original_note?"Update":"Add")+" "+(0,i.zw)(b.task.type||"task")+" notes ",1)],512),(0,a._)("div",d,[b.ready?((0,a.wg)(),(0,a.iD)("div",c,[(0,a._)("div",h,[(0,a.Uk)(' Save your notes for "'+(0,i.zw)(b.task.name)+'" in ',1),(0,a._)("a",{class:"class_name button_pointer_text",href:`/view/${b.task._class.ref}`,onClick:e[0]||(e[0]=e=>{e.preventDefault(),t.$router.push("/portal"+e.target.getAttribute("href"))}),style:(0,i.j5)({"--color-class":b.task._class.color,"--color-class-alt":b.task._class.color+"2d"})},(0,i.zw)(`P${b.task._class.period} - ${b.task._class.name}`),13,_)]),(0,a._)("div",u,[(0,a.wy)((0,a._)("textarea",{"onUpdate:modelValue":e[1]||(e[1]=t=>b.note=t),class:"styled_input styled_textarea task_note",type:"text",placeholder:"Your "+w.type_full+" Notes (Optional)"},"\r\n          ",8,k),[[o.nr,b.note]])])])):((0,a.wg)(),(0,a.iD)("img",m))],512),(0,a._)("div",p,[(0,a._)("button",{class:"close_action",onClick:e[2]||(e[2]=e=>t.$emit("close"))},"Close"),f,b.ready?((0,a.wg)(),(0,a.iD)("button",{key:0,class:(0,i.C_)(["back_action primary_styled",{loading_bg:b.loading}]),disabled:b.loading,onClick:e[3]||(e[3]=(...t)=>w.back&&w.back(...t))}," View ",10,g)):(0,a.kq)("",!0),(0,a._)("button",{class:(0,i.C_)(["continue_action",{loading_bg:b.loading}]),onClick:e[4]||(e[4]=(...t)=>w.try_submit&&w.try_submit(...t)),disabled:w.not_submittable},(0,i.zw)(b.original_note?"Update":"Add"),11,y)])],32)}var w=s(8980),v=s(2745),$=s(1708),C=s(9529),x=s.n(C),O={name:"EditTaskView",emits:["close"],mixins:[x()],data(){return{task:{},original_note:"",note:"",ready:!1,loading:!0,types:{note:"Note",task:"Assignment",test:"Test",project:"Project",quiz:"Quiz",exam:"Exam"}}},mounted(){this.$smoothReflow({el:this.$refs.contents,childTransitions:!0}),this.$smoothReflow({el:this.$refs.title,hideOverflow:!0}),this.get_task()},computed:{not_submittable(){return!this.changed},type_full(){return this.types[this.task.type]||this.task.type||"Task"},store(){return(0,w.h)()},changed(){return this.original_note!==this.note}},methods:{submit_key(t){t.ctrlKey&&"Enter"===t.code&&(t.preventDefault(),this.try_submit())},try_submit(){this.not_submittable?new $.OO("No changes to save",1e3):this.update_note()},back(){this.$router.push({name:"viewtask",params:{ref:this.$route.params.ref}})},async update_note(){this.loading=!0,this.store.set_note(this.note,this.$route.params.ref).then((()=>{new $.bF(`${this.original_note?this.note?"Updated":"Removed":"Added"} ${this.task.type||"task"} notes for ${this.task.name}`,2e3),this.back()})).catch((t=>{this.loading=!1,v.i2.error(`ðŸ“ƒ Couldn't edit ${this.task.type||"task"} notes:`,t),new $.PK(`Couldn't edit ${this.task.type||"task"} notes`,t,2e3)}))},async get_task(){const t=this.$route.params.ref.split("~").join("/");t?t.split("/").length<3&&(new $.OO("Invalid task specified",1500),this.$emit("close")):(new $.OO("No task specified",1500),this.$emit("close")),this.store.task_from_ref(t).then((t=>{t?(this.task=t,this.original={...t},this.ready=!0,this.loading=!1):(new $.OO("Couldn't find that task",2e3),v.i2.warn("âš  Couldn't find task"),this.$emit("close"));const e=this.store.note_for(this.$route.params.ref);e&&(this.note=e,this.original_note=e)})).catch((t=>{new $.PK("Error getting task",t,1500),v.i2.error("âš  Error getting task",t),this.$emit("close")}))}}},z=s(89);const D=(0,z.Z)(O,[["render",b],["__scopeId","data-v-2f9f384c"]]);var A=D}}]);
//# sourceMappingURL=118.8fa26513.js.map