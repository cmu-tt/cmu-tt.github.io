"use strict";(self["webpackChunkmvtime"]=self["webpackChunkmvtime"]||[]).push([[638],{3946:function(e,t,a){a.d(t,{Z:function(){return k}});var s=a(3396),i=a(7139);const n=["title"],l=(0,s._)("div",{class:"task_card_icon_container"},[(0,s._)("div",{class:"task_card_icon_container__img"})],-1),r=[l],o={class:"task_card_details"},c={class:"task_card_details__title"},d={class:"task_card_details__extended"},_={class:"task_card_details__extended__date"},h={class:"task_card_details__extended__type"};function u(e,t,a,l,u,g){return(0,s.wg)(),(0,s.iD)("div",{class:"task_card",style:(0,i.j5)({"--color-calendar-task":a.task.color})},[(0,s._)("div",{class:"task_card_icon",title:a.task.class_name},r,8,n),(0,s._)("div",o,[(0,s._)("div",c,(0,i.zw)(a.task.name),1),(0,s._)("div",d,[(0,s._)("span",_,(0,i.zw)(a.task.date.toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"})),1),(0,s.Uk)("  |  "),(0,s._)("span",h,(0,i.zw)(g.type_full),1)])])],4)}var g={name:"ExamCard",props:{task:{type:Object,required:!0}},computed:{type_full(){return{note:"Note",task:"Assignment",test:"Test",project:"Project",quiz:"Quiz",exam:"Exam"}[this.task.type]}}},m=a(89);const p=(0,m.Z)(g,[["render",u]]);var k=p},7638:function(e,t,a){a.r(t),a.d(t,{default:function(){return Dt}});a(7658);var s=a(3396),i=a(7139);const n={class:"portal"},l={class:"portal_content__spaced"},r={class:"portal_info"},o={class:"portal_info_title"},c={class:"portal_info_usertype"},d={class:"portal_info_date"},_={class:"portal_info_welcome"};function h(e,t,a,h,u,g){const m=(0,s.up)("LeftBar"),p=(0,s.up)("CalendarBlock"),k=(0,s.up)("RightBar"),v=(0,s.up)("router-view"),f=(0,s.up)("OverlayWrapper");return(0,s.wg)(),(0,s.iD)("main",n,[(0,s.Wm)(m,{ref:"LeftBar",onToggle_filtered_class:g.toggle_filtered_class,onClear_filters:t[0]||(t[0]=e=>u.filtered_classes=[]),onClose_right_bar:g.close_right_bar,filtered_classes:u.filtered_classes,onMounted:t[1]||(t[1]=t=>{u.loaded&&e.$refs.LeftBar.load()})},null,8,["onToggle_filtered_class","onClose_right_bar","filtered_classes"]),(0,s._)("div",{class:"portal_content",onClick:t[4]||(t[4]=e=>{g.close_right_bar(),g.close_left_bar()})},[(0,s._)("div",l,[(0,s._)("header",r,[(0,s._)("div",o,[(0,s._)("span",c,(0,i.zw)(g.store.is_teacher?"Teacher":"Student")+" Dashboard",1),(0,s._)("span",d,(0,i.zw)((new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),1)]),(0,s._)("div",_,(0,i.zw)(g.store.recently_joined?"Welcome to MVTT":g.store.non_recent_signin?"Welcome Back":g.random_welcome)+" "+(0,i.zw)(g.name)+"! ",1)]),(0,s.Wm)(p,{filtered_classes:u.filtered_classes,onTaskclick:t[2]||(t[2]=e=>g.show_task(e)),ref:"calendar",onMounted:t[3]||(t[3]=t=>{u.loaded&&e.$refs.calendar.run_get_tasks()})},null,8,["filtered_classes"])])]),(0,s.Wm)(k,{ref:"RightBar",onClose_left_bar:g.close_left_bar,onMounted:t[5]||(t[5]=t=>{u.loaded&&e.$refs.RightBar.load()})},null,8,["onClose_left_bar"]),"portal"!==e.$route.name?((0,s.wg)(),(0,s.j4)(f,{key:0,onClose:t[7]||(t[7]=t=>g.close_path?e.$router.push(g.close_path):e.$router.push("/portal"))},{default:(0,s.w5)((e=>[(0,s.Wm)(v,{class:"router_center_view",onClose:e.close,onClear_filters:t[6]||(t[6]=e=>u.filtered_classes=[])},null,8,["onClose"])])),_:1})):(0,s.kq)("",!0)])}const u=e=>((0,s.dD)("data-v-4261d899"),e=e(),(0,s.Cn)(),e),g={class:"sidebar_overflow"},m=u((()=>(0,s._)("div",{class:"branding-title gohome"},"MV Test Tracker",-1))),p=u((()=>(0,s._)("div",{class:"flex_spacer"},null,-1))),k=u((()=>(0,s._)("div",{class:"flex_spacer"},null,-1))),v=["_theme"],f=u((()=>(0,s._)("div",{class:"theme_icon"},null,-1))),y=u((()=>(0,s._)("div",{class:"toggle_text"},"Switch Theme",-1))),w=[f,y];function b(e,t,a,n,l,r){const o=(0,s.up)("ActionsPanel"),c=(0,s.up)("ClassList"),d=(0,s.up)("SidebarToggle");return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["left-bar portal_sidebar",{active:l.sidebar_open}]),onClick:t[1]||(t[1]=(...e)=>r.show_if_inactive&&r.show_if_inactive(...e))},[(0,s._)("div",g,[m,p,r.store&&r.store.is_teacher?((0,s.wg)(),(0,s.j4)(o,{key:0})):(0,s.kq)("",!0),(0,s.Wm)(c,(0,i.vs)((0,s.F4)(e.$attrs)),null,16),k]),(0,s._)("button",{_theme:r.store.get_theme,class:"theme_button click-action",title:"Switch Theme",onClick:t[0]||(t[0]=(...e)=>r.store.toggle_theme&&r.store.toggle_theme(...e))},w,8,v),(0,s.Wm)(d,{class:"right",onClick:r.close_sidebar},null,8,["onClick"])],2)}const C=e=>((0,s.dD)("data-v-2e4cb15c"),e=e(),(0,s.Cn)(),e),D={class:"sidebar_toggle click-action",title:"Close Sidebar"},T=C((()=>(0,s._)("div",{class:"arrow-icon"},null,-1))),$=[T];function S(e,t,a,i,n,l){return(0,s.wg)(),(0,s.iD)("button",D,$)}var x={name:"SidebarToggle"},L=a(89);const M=(0,L.Z)(x,[["render",S],["__scopeId","data-v-2e4cb15c"]]);var j=M;const z=e=>((0,s.dD)("data-v-84939dfa"),e=e(),(0,s.Cn)(),e),B={class:"class_list"},E=["title"],W=z((()=>(0,s._)("hr",{class:"class_list_hr"},null,-1))),I=["onClick"],N=["_email","title","onClick"],O={key:0,class:"class_swatch__icon class_swatch_remove__icon"},P={key:1,class:"class_swatch__icon class_swatch_edit__icon"},Z={key:0,class:"class_name"},q={key:1,class:"class_name"},H=z((()=>(0,s._)("div",{class:"class_swatch"},[(0,s._)("div",{class:"class_swatch__add_icon"})],-1))),U=z((()=>(0,s._)("span",{class:"class_name"},"Join a Class",-1))),Y=[H,U];function R(e,t,a,n,l,r){return(0,s.wg)(),(0,s.iD)("div",B,[(0,s._)("div",{class:(0,i.C_)(["class_list__not_empty",{filtering:!!a.filtered_classes.length}])},[(0,s._)("h5",{onClick:t[0]||(t[0]=t=>e.$emit("clear_filters")),title:a.filtered_classes.length?"Click to clear filters":""}," Classes ",8,E),W,(0,s._)("div",{class:(0,i.C_)(["classes_container",{filtering:!!a.filtered_classes.length}])},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.classes,(t=>((0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["classes_container_class",{filter_active:a.filtered_classes.includes(t.id)}]),key:t.name,onClick:a=>e.$emit("toggle_filtered_class",t.id),style:(0,i.j5)({"--color-class":t.color,"--color-class-alt":t.color+"40"})},[(0,s._)("div",{class:"class_swatch",_email:t.email,title:r.store.is_teacher&&t.email==this.store.user.email?"Edit Class":"Leave Class",onClick:e=>{r.store.is_teacher&&t.email==this.store.user.email?r.edit_class(t):r.leave_class(t),e.stopPropagation()}},[r.store.is_teacher&&t.email==this.store.user.email?((0,s.wg)(),(0,s.iD)("div",P)):((0,s.wg)(),(0,s.iD)("div",O))],8,N),t.period?((0,s.wg)(),(0,s.iD)("span",Z,"P"+(0,i.zw)(t.period)+" - "+(0,i.zw)(t.name),1)):((0,s.wg)(),(0,s.iD)("span",q,(0,i.zw)(t.name),1))],14,I)))),128)),(r.store.is_teacher,(0,s.wg)(),(0,s.iD)("div",{key:0,class:"classes_container_class classes_container_class__add_class",onClick:t[1]||(t[1]=t=>e.$router.push("/portal/add"))},Y))],2)],2)])}var A=a(8980),K={props:{filtered_classes:{type:Array,default:()=>[]}},name:"ClassList",computed:{store(){return(0,A.h)()},classes(){return this.store.classes.map((e=>({...e,email:e.id.split("/")[0]})))}},emits:["toggle_filtered_class","clear_filters"],methods:{clean_ref(e){let[t,a]=e.split("/");return t=t.split("@")[0],[t,a].join("~")},leave_class(e){this.$router.push({name:"leave",params:{ref:this.clean_ref(e.id)}})},edit_class(e){this.$router.push({name:"editclass",params:{ref:this.clean_ref(e.id)}})}}};const F=(0,L.Z)(K,[["render",R],["__scopeId","data-v-84939dfa"]]);var V=F;const X={class:"teacher_actions"},J=["onClick"],Q=(0,s._)("div",{class:"teacher_action__icon icon__add"},null,-1),G={class:"teacher_action__text"},ee=(0,s._)("div",{class:"teacher_action__icon icon__create"},null,-1),te=(0,s._)("div",{class:"teacher_action__text"},"Create a Class",-1),ae=[ee,te];function se(e,t,a,n,l,r){return(0,s.wg)(),(0,s.iD)("div",X,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.task_types,(t=>((0,s.wg)(),(0,s.iD)("div",{key:t[0],class:"teacher_action",onClick:a=>e.$router.push({name:"newtask",params:{tasktype:t[0]}})},[Q,(0,s._)("div",G,(0,i.zw)(t[1]),1)],8,J)))),128)),(0,s._)("div",{class:"teacher_action",onClick:t[0]||(t[0]=t=>e.$router.push("/portal/create"))},ae)])}var ie={data(){return{task_types:[["note","Add a Note"],["task","Schedule a Task or Test"]]}}};const ne=(0,L.Z)(ie,[["render",se]]);var le=ne,re=a(1708),oe={name:"LeftBar",components:{SidebarToggle:j,ClassList:V,ActionsPanel:le},emits:["close_right_bar","set_class","mounted"],data(){return{sidebar_open:!1}},computed:{store(){return(0,A.h)()}},mounted(){this.$emit("mounted"),window.addEventListener("resize",this.close_sidebar)},unmounted(){window.removeEventListener("resize",this.close_sidebar)},methods:{placeholderToast:re.gy,show_if_inactive(){this.sidebar_open||(this.sidebar_open=!0),this.$emit("close_right_bar")},close_sidebar(){this.sidebar_open&&setTimeout((()=>this.sidebar_open=!1),10)},set_class(e){this.$emit("set_class",e)},load(){this.loading=!1}}};const ce=(0,L.Z)(oe,[["render",b],["__scopeId","data-v-4261d899"]]);var de=ce;const _e=e=>((0,s.dD)("data-v-69ef0986"),e=e(),(0,s.Cn)(),e),he={class:"sidebar_overflow"},ue=_e((()=>(0,s._)("div",{class:"auth-action can-logout doprompt"},"Log Out",-1))),ge=_e((()=>(0,s._)("div",{class:"flex_spacer"},null,-1))),me=_e((()=>(0,s._)("div",{class:"flex_spacer"},null,-1))),pe=_e((()=>(0,s._)("div",{class:"settings_icon"},null,-1))),ke=[pe];function ve(e,t,a,n,l,r){const o=(0,s.up)("UpcomingTests"),c=(0,s.up)("SidebarToggle");return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["right-bar portal_sidebar",{active:l.sidebar_open}]),onClick:t[1]||(t[1]=(...e)=>r.show_if_inactive&&r.show_if_inactive(...e))},[(0,s._)("div",he,[ue,ge,(0,s.Wm)(o,{loading:l.loading},null,8,["loading"]),me]),(0,s._)("button",{class:"settings_button click-action",title:"Settings",onClick:t[0]||(t[0]=t=>e.$router.push("/settings"))},ke),(0,s.Wm)(c,{onClick:r.close_sidebar},null,8,["onClick"])],2)}const fe=e=>((0,s.dD)("data-v-66321280"),e=e(),(0,s.Cn)(),e),ye={class:"upcoming_tasks"},we={key:0,class:"upcoming_tasks__not_empty"},be=fe((()=>(0,s._)("h5",null,"Upcoming",-1))),Ce=fe((()=>(0,s._)("hr",{class:"upcoming_tasks_hr"},null,-1))),De={key:0,class:"tasks_container"},Te={key:1,class:"loading_tasks loading_icon",alt:"Loading..."},$e={key:1,class:"upcoming_tasks__empty"},Se=fe((()=>(0,s._)("h5",null,"No Upcoming Tasks!",-1))),xe=[Se];function Le(e,t,a,i,n,l){const r=(0,s.up)("ExamCard");return(0,s.wg)(),(0,s.iD)("div",ye,[l.tasks&&l.tasks.length||a.loading?((0,s.wg)(),(0,s.iD)("div",we,[be,Ce,l.tasks&&l.tasks.length?((0,s.wg)(),(0,s.iD)("div",De,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.tasks,(e=>((0,s.wg)(),(0,s.j4)(r,{class:"tasks_container_task",task:e,key:e.name,onClick:t=>l.show_task(e)},null,8,["task","onClick"])))),128))])):((0,s.wg)(),(0,s.iD)("img",Te))])):((0,s.wg)(),(0,s.iD)("div",$e,xe))])}var Me=a(3946),je={name:"UpcomingTasks",props:{loading:{type:Boolean,default:!1}},components:{ExamCard:Me.Z},computed:{store(){return(0,A.h)()},tasks(){return this.store.tasks?this.store.tasks.filter((e=>(e?.date?.getTime?e.date.getTime():0)>=Date.now()&&!e.is_assignment&&"note"!=e.type)).sort(((e,t)=>e.date<t.date?-1:e.date>t.date?1:0)).slice(0,6):[]}},methods:{show_task(e){this.$router.push({name:"viewtask",params:{ref:e.ref.replace("@mvla.net","").split("/").join("~")}})}}};const ze=(0,L.Z)(je,[["render",Le],["__scopeId","data-v-66321280"]]);var Be=ze,Ee={name:"RightBar",components:{SidebarToggle:j,UpcomingTests:Be},emits:["close_left_bar","mounted"],data(){return{sidebar_open:!1,loading:!0}},mounted(){this.$emit("mounted"),window.addEventListener("resize",this.close_sidebar)},unmounted(){window.removeEventListener("resize",this.close_sidebar)},methods:{show_if_inactive(){this.sidebar_open||(this.sidebar_open=!0),this.$emit("close_left_bar")},close_sidebar(){this.sidebar_open&&setTimeout((()=>this.sidebar_open=!1),10)},load(){this.loading=!1}}};const We=(0,L.Z)(Ee,[["render",ve],["__scopeId","data-v-69ef0986"]]);var Ie=We;const Ne=e=>((0,s.dD)("data-v-3fac22b6"),e=e(),(0,s.Cn)(),e),Oe={class:"calendar_header"},Pe=["title"],Ze={class:"calendar_actions"},qe=Ne((()=>(0,s._)("div",{class:"action_icon arrow-icon left"},null,-1))),He=[qe],Ue=Ne((()=>(0,s._)("div",{class:"action_icon arrow-icon right"},null,-1))),Ye=[Ue],Re={class:"calendar_day__weekday_label__text"},Ae=["_date","onDragover"],Ke={class:"calendar_day_date"},Fe={class:"calendar_day_date__short"},Ve={class:"calendar_day_date__long",style:{display:"none"}},Xe={class:"calendar_day_tasks"},Je=["is_note","title","draggable","onDragstart","href","onClick"],Qe={key:0,class:"calendar_day_task_editable"},Ge={key:1},et=Ne((()=>(0,s._)("span",{class:"calendar_day_task__swatch"},null,-1))),tt=Ne((()=>(0,s._)("span",{class:"calendar_day_task__note"}," NOTE ",-1))),at=[et,tt],st={key:2},it={key:0,class:"calendar__no_tasks",style:{display:"none"}};function nt(e,t,a,n,l,r){const o=(0,s.up)("LoadingCover");return(0,s.wg)(),(0,s.iD)("main",{class:"calendar",onDrag:t[4]||(t[4]=(...e)=>r.check_leave&&r.check_leave(...e))},[l.is_ready?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(o,{key:0,class:"calendar_loading",covering:"Calendar Tasks"})),(0,s._)("div",Oe,[(0,s._)("div",{class:"calendar_date",title:"Currently viewing "+l.loaded_month.toLocaleDateString(void 0,{month:"long",year:"numeric"})},(0,i.zw)(l.loaded_month.toLocaleDateString("en-US",{month:"long",year:"numeric"})),9,Pe),(0,s._)("nav",Ze,[(0,s._)("button",{class:"calendar_action",onClick:t[0]||(t[0]=(...e)=>r.prev_month&&r.prev_month(...e)),title:"Previous month"},He),(0,s._)("button",{class:"calendar_action",onClick:t[1]||(t[1]=(...e)=>r.this_month&&r.this_month(...e)),title:"Current month"},[(0,s._)("div",{class:(0,i.C_)(["action_icon cal-icon",{alt:l.tasks.length}])},null,2)]),(0,s._)("button",{class:"calendar_action",onClick:t[2]||(t[2]=(...e)=>r.next_month&&r.next_month(...e)),title:"Next month"},Ye)])]),(0,s._)("div",{class:"calendar_days_container",style:(0,i.j5)({"--color-dragging":l.drag.task&&l.drag.task.color,"--color-dragging-alt":l.drag.task&&l.drag.task.color+"80"})},[(0,s._)("div",{class:(0,i.C_)(["calendar_days",{calendar_days__current:r.day_matches(l.loaded_month,new Date((new Date).setDate(1))),calendar_days__changed:l.is_changed}]),ref:"calendar_days"},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],(e=>(0,s._)("div",{class:"calendar_day calendar_day__weekday_label",key:e},[(0,s._)("span",Re,(0,i.zw)(e),1)]))),64)),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.days,(a=>((0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["calendar_day",{calendar_day__placeholder:a.is_placeholder,calendar_day__hastask:!!a.tasks&&a.tasks.length,calendar_day__today:a.is_today,calendar_day__past:a.is_past,calendar_day__drag_to:l.drag.to==a.date,calendar_day__drag_from:l.drag.from==a.date}]),_date:a.date.toISOString().split("T")[0],onDragover:e=>{l.drag.to!=a.date&&(l.drag.to=l.drag.to!=l.drag.from?a.date:null)},key:a.date},[(0,s._)("div",Ke,[(0,s._)("span",Fe,(0,i.zw)(new Date(a.date).getDate()),1),(0,s._)("span",Ve,(0,i.zw)(new Date(a.date).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})),1)]),(0,s._)("div",Xe,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.tasks,(n=>((0,s.wg)(),(0,s.iD)("a",{class:(0,i.C_)(["calendar_day_task click-action",{calendar_day_task__dragging:l.drag.task==n,calendar_day_task__loading:l.drag.task==n&&l.drag.load}]),is_note:"note"===n.type,key:n.name,title:n.name,draggable:n&&r.store.is_teacher&&r.store.user&&n.ref.split("/")[0]==r.store.active_doc.email,onDragstart:e=>l.drag={task:n,from:a.date},onDragend:t[3]||(t[3]=(...e)=>r.drag_drop&&r.drag_drop(...e)),style:(0,i.j5)({"--color-calendar-task":n.color,"--color-calendar-task-alt":n.color+"40"}),href:"/view/"+r.get_link(n.ref),onClick:t=>{t.preventDefault(),e.$emit("taskclick",n)}},[n&&r.store.is_teacher&&r.store.user&&n.ref.split("/")[0]==r.store.active_doc.email?((0,s.wg)(),(0,s.iD)("div",Qe,[(0,s._)("span",{class:(0,i.C_)(["task_icon task_edit__icon",{loading_bg:l.drag.load}])},null,2)])):(0,s.kq)("",!0),"note"===n.type?((0,s.wg)(),(0,s.iD)("span",Ge,at)):((0,s.wg)(),(0,s.iD)("span",st,(0,i.zw)(n.name),1))],46,Je)))),128))])],42,Ae)))),128)),r.tasks_loaded_month?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",it," Relax! No Tasks. "))],2)],4)],32)}const lt=e=>((0,s.dD)("data-v-5a6b564c"),e=e(),(0,s.Cn)(),e),rt=["title"],ot=lt((()=>(0,s._)("div",{class:"loading_cover__overlay"},null,-1))),ct={class:"loading_cover__content"},dt={class:"loading_cover__content__icon"},_t=(0,s.uE)('<defs data-v-5a6b564c><circle id="dot" r="3" data-v-5a6b564c></circle></defs><g fill="var(--color-loading-dot, #000)" data-v-5a6b564c><circle cx="33%" cy="50%" r="3" data-v-5a6b564c><animate attributeName="r" values="3;7;3" dur="1s" repeatCount="indefinite" calcMode="spline" keyTimes="0;0.5;1" keySplines="0.42 0 0.58 1;0.42 0 0.58 1" data-v-5a6b564c></animate><animate attributeName="opacity" values="0.2;1;0.2" dur="1s" repeatCount="indefinite" calcMode="spline" keyTimes="0;0.5;1" keySplines="0.42 0 0.58 1;0.42 0 0.58 1" data-v-5a6b564c></animate></circle><circle cx="50%" cy="50%" r="3" data-v-5a6b564c><animate attributeName="r" values="3;7;3" dur="1s" repeatCount="indefinite" calcMode="spline" keyTimes="0;0.5;1" keySplines="0.42 0 0.58 1;0.42 0 0.58 1" begin="0.2s" data-v-5a6b564c></animate><animate attributeName="opacity" values="0.2;1;0.2" dur="1s" repeatCount="indefinite" calcMode="spline" keyTimes="0;0.5;1" keySplines="0.42 0 0.58 1;0.42 0 0.58 1" begin="0.2s" data-v-5a6b564c></animate></circle><circle cx="67%" cy="50%" r="3" data-v-5a6b564c><animate attributeName="r" values="3;7;3" dur="1s" repeatCount="indefinite" calcMode="spline" keyTimes="0;0.5;1" keySplines="0.42 0 0.58 1;0.42 0 0.58 1" begin="0.4s" data-v-5a6b564c></animate><animate attributeName="opacity" values="0.2;1;0.2" dur="1s" repeatCount="indefinite" calcMode="spline" keyTimes="0;0.5;1" keySplines="0.42 0 0.58 1;0.42 0 0.58 1" begin="0.4s" data-v-5a6b564c></animate></circle></g>',2),ht=[_t];function ut(e,t,a,n,l,r){return(0,s.wg)(),(0,s.iD)("div",{class:"loading_cover",title:"Loading "+a.covering},[ot,(0,s._)("div",ct,[(0,s._)("div",dt,[((0,s.wg)(),(0,s.iD)("svg",{viewBox:"0 0 100 20",style:(0,i.j5)({width:"calc(33% + 100px)",minWidth:"100px",maxWidth:"400px"})},ht,4))]),(0,s.WI)(e.$slots,"default",{},void 0,!0)])],8,rt)}var gt={name:"LoadingCover",props:{covering:{type:String,default:"Content"}}};const mt=(0,L.Z)(gt,[["render",ut],["__scopeId","data-v-5a6b564c"]]);var pt=mt,kt=a(2745),vt={name:"CalendarBlock",components:{LoadingCover:pt},props:{filtered_classes:Array,default:()=>[]},emits:["taskclick","mounted"],data(){return{loaded_month:new Date((new Date).setDate(1)),is_ready:!1,tasks:[],is_changed:!1,drag:{}}},mounted(){(0,kt.E)("📅 Calendar mounted"),this.$emit("mounted"),this.tasks=this.store.tasks},methods:{check_leave(e){try{const t=this.$refs.calendar_days.getBoundingClientRect();this.drag.to&&(e.clientX||e.clientX)&&(e.clientX<t.left||e.clientX>t.right||e.clientY<t.top||e.clientY>t.bottom)&&(this.drag.to=null)}catch(t){(0,kt.E)("🔥 Couldn't check if mouse left calendar",t)}},drag_drop(){if(this.drag.to&&this.drag.to!=this.drag.from&&this.drag.task){let e=this.drag.to;this.drag.load=!0,this.drag.to=null,this.store.update_task(this.drag.task.ref,{...this.drag.task,date:e.toISOString().split("T")[0]}).then((()=>{new re.bF(`Moved ${this.drag.task.type} ${this.drag.task.name?'"'+this.drag.task.name+'" ':""}to ${e.toLocaleDateString()}`,2e3),(0,kt.E)("📅 Moved task date"),this.drag={}})).catch((e=>{new re.PK("Couldn't update task",e,2e3),(0,kt.E)("🔥 Couldn't update task",e),this.drag={}}))}else this.drag={}},format_date(e){return e.toISOString().split("T")[0]||""},day_matches(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()},get_day_tasks(e){return this.tasks.filter((t=>{const a=new Date(t.date);return this.day_matches(a,e)&&(!this.filtered_classes.length||this.filtered_classes.includes(t.class_id))})).sort(((e,t)=>{if("note"==e.type&&"note"!=t.type)return-1}))},next_month(){this.is_changed=!0,this.loaded_month=new Date(this.loaded_month.setMonth(this.loaded_month.getMonth()+1))},this_month(){let e=new Date((new Date).setDate(1));this.day_matches(this.loaded_month,e)&&(this.is_changed=!this.is_changed),this.loaded_month=e},prev_month(){this.is_changed=!0,this.loaded_month=new Date(this.loaded_month.setMonth(this.loaded_month.getMonth()-1))},run_get_tasks(){this.tasks=this.store.tasks,this.is_ready=!0},get_link(e){let[t,a,s]=e.split("/");return t=t.split("@")[0],[t,a,s].join("~")}},computed:{tasks_loaded_month(){return this.tasks.some((e=>{new Date(e.date);return!0}))},store(){return(0,A.h)()},days(){const e=[],t=new Date((new Date).toISOString().split("T")[0]),a=this.loaded_month.getTime();function s(){return new Date(a)}const i=new Date(s().setDate(1)),n=new Date(s().setMonth(s().getMonth()+1,0));for(let l=i.getDay();l>0;l--){const a=new Date(s().setDate(-l));e.push({date:a,tasks:this.get_day_tasks(a),is_placeholder:!0,is_past:a.getTime()<t.getTime()})}for(let l=1;l<=n.getDate();l++){const a=new Date(s().setDate(l));e.push({date:a,tasks:this.get_day_tasks(a),is_today:this.day_matches(a,new Date),is_past:a.getTime()<t.getTime()})}for(let l=1;e.length<42;l++){const a=new Date(s().setDate(n.getDate()+l));e.push({date:a,tasks:this.get_day_tasks(a),is_placeholder:!0,is_past:a.getTime()<t.getTime()})}return e}},watch:{"store.classes":{handler(e,t){e.length!=t.length&&this.is_ready&&((0,kt.E)("📦 Classes array length changed, calendar updating tasks"),this.store.fetch_classes().then((()=>{this.run_get_tasks()})).catch((e=>{(0,kt.E)("🔥 Couldn't fetch classes",e)})))},deep:!0},"store.tasks":{handler(){this.tasks=this.store.tasks},deep:!0}}};const ft=(0,L.Z)(vt,[["render",nt],["__scopeId","data-v-3fac22b6"]]);var yt=ft,wt=a(3917),bt={name:"AppPortal",components:{LeftBar:de,RightBar:Ie,CalendarBlock:yt,OverlayWrapper:wt.Z},data(){return{filtered_classes:[],welcomes:["Welcome","Hi","Hello","Hey","Howdy"],loaded:!1}},computed:{close_path(){return this.$route?.query?.redirect||this.$route?.meta?.close_path},name(){return this.store.user?.displayName?.split(" ")[0]||"User"},did_survey(){return this.store.done_daily_survey},random_welcome(){return this.welcomes[Math.floor(Math.random()*this.welcomes.length)]},store(){return(0,A.h)()}},methods:{do_survey(){this.$router.replace({name:"daily",query:{redirect:this.$route.fullPath}}),new re.OO("Please complete the daily survey to use MVTT today!",3e3)},close_left_bar(){this.$refs.LeftBar.close_sidebar()},close_right_bar(){this.$refs.RightBar.close_sidebar()},show_task(e){this.$router.push({name:"viewtask",params:{ref:e.ref.replace("@mvla.net","").split("/").join("~")}})},toggle_filtered_class(e){this.filtered_classes.includes(e)?this.filtered_classes=this.filtered_classes.filter((t=>t!==e)):this.filtered_classes.push(e)},check_and_do_survey(){this?.store?.user&&!this?.did_survey&&!0!==this.$route?.meta?.noSurvey&&this.do_survey()},check_and_do_join(){this.store.done_join_form||(this.$router.push({name:"join",query:{redirect:this.$route.fullPath}}),new re.OO("Please fill out the join form to use MVTT!",3e3))}},mounted(){(0,kt.E)("🏗 Portal mounted"),this.check_and_do_join(),this.check_and_do_survey(),this.store.fetch_classes().then((()=>{this.$refs.calendar.run_get_tasks(),this.$refs.RightBar.load(),this.$refs.LeftBar.load(),this.loaded=!0})).catch((e=>{(0,kt.E)("🔥 Couldn't fetch classes",e)}))},watch:{did_survey(){this.check_and_do_survey()},$route(){this.check_and_do_survey()},store:{handler(){this.check_and_do_join()},deep:!0}}};const Ct=(0,L.Z)(bt,[["render",h],["__scopeId","data-v-ce0069d2"]]);var Dt=Ct}}]);
//# sourceMappingURL=638.571f5dff.js.map