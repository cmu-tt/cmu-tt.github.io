{"version":3,"file":"js/782.54f2fcea.js","mappings":"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","sources":["webpack://mvtime/./src/views/Portal/StatsModal.vue","webpack://mvtime/./src/views/Portal/StatsModal.vue?f9cd"],"sourcesContent":["<template>\r\n  <main class=\"entercode\">\r\n    <header class=\"modal_header\">\r\n      <h2 class=\"header_style modal_header_title\">View Statistics</h2>\r\n    </header>\r\n    <div class=\"overlay_contents\" ref=\"contents\">\r\n      <div class=\"overlay_contents_text\">\r\n        The daily surveys you have completed are displayed below. To view your individual responses,\r\n        click on the data point.\r\n      </div>\r\n      <br />\r\n      <nav class=\"stats_view_controls_wrapper\">\r\n        <div class=\"stats_view_controls\">\r\n          <button\r\n            @click=\"\r\n              if (active.includes(tag.filter) && active.length > 1) {\r\n                active.splice(active.indexOf(tag.filter), 1);\r\n              } else {\r\n                active.push(tag.filter);\r\n              }\r\n            \"\r\n            class=\"stats_view_control__option\"\r\n            v-for=\"tag in filters\"\r\n            :key=\"tag.filter\"\r\n            :class=\"{ active: active.includes(tag.filter) && is_ready }\"\r\n          >\r\n            {{ tag.name }}\r\n          </button>\r\n        </div>\r\n        <span class=\"flex_spacer\"></span>\r\n        <button\r\n          class=\"stats_view_control__refresh\"\r\n          @click=\"\r\n            if (is_ready) {\r\n              try_update();\r\n            }\r\n          \"\r\n          :class=\"{ disabled: !can_update || !is_ready }\"\r\n        >\r\n          Update\r\n        </button>\r\n      </nav>\r\n      <div class=\"stats_view_container alt_bg\" :class=\"{ loading_bg: !is_ready }\">\r\n        <div class=\"stats_view_wrapper\" v-if=\"surveys.length\">\r\n          <apexchart\r\n            class=\"stats_view\"\r\n            type=\"line\"\r\n            :series=\"graphs\"\r\n            width=\"100%\"\r\n            height=\"100%\"\r\n            :options=\"{\r\n              xaxis: {\r\n                type: 'datetime',\r\n                labels: {\r\n                  show: false,\r\n                },\r\n                categories: surveys.map((survey) => survey.data.time),\r\n              },\r\n              yaxis: {\r\n                labels: {\r\n                  show: false,\r\n                },\r\n                // scale from 0 to 5\r\n                min: 0,\r\n                max: 5,\r\n                tickAmount: 5,\r\n                decimalsInFloat: 0,\r\n              },\r\n              legend: {\r\n                show: true,\r\n                showForSingleSeries: true,\r\n              },\r\n              theme: {\r\n                mode: store.theme,\r\n              },\r\n              chart: {\r\n                background: 'var(--color-overlay-input)',\r\n                fontFamily: 'inherit',\r\n                toolbar: {\r\n                  show: false,\r\n                },\r\n              },\r\n              stroke: {\r\n                curve: 'smooth',\r\n                width: 3,\r\n              },\r\n              tooltip: {\r\n                enabled: true,\r\n                // don't show the label below the axis, but do show it in the tooltip\r\n                x: {\r\n                  format: 'ddd MMM d',\r\n                },\r\n              },\r\n            }\"\r\n          ></apexchart>\r\n          <!-- <div class=\"stats_view\"></div> -->\r\n        </div>\r\n      </div>\r\n      <br />\r\n      <div class=\"overlay_contents_text\">\r\n        We appreciate your contributions towards our research. If you have any questions, please\r\n        <router-link to=\"/contact\">contact us</router-link>!\r\n      </div>\r\n    </div>\r\n    <div class=\"bottom_actions\">\r\n      <!-- <button class=\"close_action\" @click=\"$emit('close')\">Close</button> -->\r\n      <div class=\"flex_spacer\"></div>\r\n      <button class=\"continue_action\" @click=\"$emit('close')\">Close</button>\r\n    </div>\r\n  </main>\r\n</template>\r\n\r\n<script>\r\nimport { useMainStore } from \"@/store\";\r\nimport { ErrorToast, WarningToast } from \"@svonk/util\";\r\nimport { _status } from \"../../common\";\r\nexport default {\r\n  name: \"StatsModal\",\r\n  emits: [\"close\"],\r\n  data() {\r\n    return {\r\n      is_ready: false,\r\n      can_update: true,\r\n      min_delay: 1000 * 15,\r\n      surveys: [],\r\n      active: [\"stress\", \"sentiment\"],\r\n      filters: [\r\n        {\r\n          name: \"Stress Level\",\r\n          filter: \"stress\",\r\n          data: {\r\n            index: 1,\r\n            range: {\r\n              from: 1,\r\n              to: 3,\r\n            },\r\n            scale(data) {\r\n              return ({ positive: 3, neutral: 2, negative: 1 }[data.sentiment] - 1) * (5 / 2);\r\n            },\r\n            label(data) {\r\n              return data.sentiment.charAt(0).toUpperCase() + data.sentiment.slice(1);\r\n            },\r\n          },\r\n        },\r\n        {\r\n          name: \"Mood\",\r\n          filter: \"sentiment\",\r\n          data: {\r\n            index: 2,\r\n            range: {\r\n              from: 1,\r\n              to: 5,\r\n            },\r\n            scale(data) {\r\n              return ((data.sentiment * 5) / 100 - 1) * (5 / 4);\r\n            },\r\n            label(data) {\r\n              return data.sentiment + \"%\";\r\n            },\r\n          },\r\n        },\r\n        {\r\n          name: \"Workload\",\r\n          filter: \"upcoming\",\r\n          data: {\r\n            index: 4,\r\n            range: {\r\n              from: 0,\r\n              to: 6,\r\n            },\r\n            scale(data) {\r\n              return Math.min(data.num || data.tasks?.length || 0, 10) / 2;\r\n            },\r\n            label(data) {\r\n              return (data.num || data.tasks?.length || 0) + \" tasks\";\r\n            },\r\n          },\r\n        },\r\n      ],\r\n    };\r\n  },\r\n  computed: {\r\n    store() {\r\n      return useMainStore();\r\n    },\r\n    completed() {\r\n      return this.store?.active_doc?.done_surveys || [];\r\n    },\r\n    graphs() {\r\n      let graphs = this.filters\r\n        .filter((f) => this.active.includes(f.filter))\r\n        .map((f) => {\r\n          return {\r\n            name: f.name,\r\n            data: this.surveys.map((survey) => {\r\n              return f.data.scale(survey.data.responses[f.data.index].data);\r\n            }),\r\n            labels: this.surveys.map((survey) => {\r\n              return f.data.label(survey.data.responses[f.data.index].data);\r\n            }),\r\n          };\r\n        });\r\n      return graphs;\r\n    },\r\n  },\r\n  methods: {\r\n    try_update() {\r\n      if (this.can_update) {\r\n        this.update(true);\r\n        _status.log(\"Manualling refreshing survey data\");\r\n      } else {\r\n        new WarningToast(\"Please wait before updating again\", 2000);\r\n        _status.warn(\"Blocked quick refresh of survey data \");\r\n      }\r\n    },\r\n    process(data) {\r\n      this.surveys = data.filter((survey) => !survey.error);\r\n      // map index onto surveys\r\n      this.surveys.forEach((survey, index) => {\r\n        survey.data.index = index;\r\n      });\r\n      this.is_ready = true;\r\n    },\r\n    update(force = false) {\r\n      this.is_ready = false;\r\n      this.can_update = false;\r\n      this.last_update = Date.now();\r\n      this.surveys = [];\r\n      this.store\r\n        .get_cached_surveys(this.completed, force)\r\n        .then((data) => {\r\n          this.process(data);\r\n          // set a timeout to allow the user to update again\r\n          setTimeout(() => {\r\n            this.can_update = true;\r\n          }, this.min_delay);\r\n        })\r\n        .catch((err) => {\r\n          new ErrorToast(\"Failed to get statistics\", err, 5000);\r\n          this.is_ready = true;\r\n          this.can_update = true;\r\n        });\r\n    },\r\n  },\r\n  mounted() {\r\n    this.update();\r\n  },\r\n  created() {},\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.stats_view_container {\r\n  width: 100%;\r\n  background-color: var(--color-overlay-input);\r\n  color: var(--color-on-overlay-input);\r\n  border: none;\r\n  border-radius: var(--radius-overlay-input);\r\n  /* overflow-x: auto; */\r\n}\r\n.stats_view_container {\r\n  height: 250px;\r\n}\r\n\r\n/* scrollbar */\r\n.stats_view_container::-webkit-scrollbar-corner {\r\n  display: none;\r\n}\r\n.stats_view_container::-webkit-scrollbar {\r\n  background: var(--color-overlay-input);\r\n  width: 12px;\r\n  height: 12px;\r\n  border-radius: var(--radius-overlay-input);\r\n}\r\n\r\n.stats_view_container::-webkit-scrollbar-thumb {\r\n  width: 8px;\r\n  height: 8px;\r\n  background: var(--color-overlay-input-scrollbar);\r\n  border-radius: 10px;\r\n  border: 4px solid var(--color-overlay-input);\r\n}\r\n\r\n/* empty */\r\n.stats_view_container:empty {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  font-size: inherit;\r\n  height: 100px;\r\n}\r\n.stats_view_container:empty::before {\r\n  content: \"No data to display\";\r\n  opacity: 0.5;\r\n}\r\n/* entry wrapper */\r\n.stats_view_container > .stats_view_wrapper {\r\n  padding: calc(var(--padding-overlay-input) - 5px) calc(var(--padding-overlay-input) - 10px);\r\n  padding-bottom: var(--padding-overlay-input);\r\n  height: 100%;\r\n  min-width: 100%;\r\n  width: fit-content;\r\n}\r\n.stats_view_container > .stats_view_wrapper > .stats_view {\r\n  height: 100%;\r\n  min-width: 100%;\r\n  position: relative;\r\n}\r\n/* entries */\r\n.stats_view_container > .stats_view_wrapper > .stats_view > .stats_view__entry {\r\n  height: 5px;\r\n  width: 5px;\r\n  border-radius: 10px;\r\n  /* background: var(--color-on-overlay-input); */\r\n  background: var(--color-theme);\r\n  bottom: calc(100% * var(--y-stat) * var(--h-scale-stat));\r\n  left: calc(100% * var(--x-stat) * var(--w-scale-stat));\r\n  position: absolute;\r\n}\r\n\r\n/* controls */\r\n.stats_view_controls_wrapper {\r\n  margin-bottom: calc(var(--padding-overlay-input) / 2);\r\n  display: flex;\r\n  flex-flow: row wrap;\r\n}\r\n.stats_view_controls {\r\n  height: 30px;\r\n  display: flex;\r\n  flex-flow: row nowrap;\r\n  border-radius: var(--radius-overlay-input);\r\n  overflow: hidden;\r\n  width: fit-content;\r\n}\r\n.stats_view_controls > button,\r\n.stats_view_control__refresh {\r\n  flex: 0 1 auto;\r\n  height: 30px;\r\n  background: var(--color-overlay-input-alt);\r\n  color: var(--color-on-overlay-input-alt);\r\n  border: none;\r\n  padding: 0 var(--padding-overlay-input);\r\n  font-size: 0.9em;\r\n  font-weight: 600;\r\n  user-select: none;\r\n}\r\n.stats_view_control__refresh {\r\n  border-radius: var(--radius-overlay-input);\r\n}\r\n.stats_view_control__refresh.disabled {\r\n  cursor: not-allowed;\r\n}\r\n.stats_view_controls > button.active,\r\n.stats_view_control__refresh:not(.disabled) {\r\n  background: var(--color-overlay-input-active);\r\n  color: var(--color-on-overlay-input);\r\n}\r\n</style>\r\n","import { render } from \"./StatsModal.vue?vue&type=template&id=cc5ad82a&scoped=true\"\nimport script from \"./StatsModal.vue?vue&type=script&lang=js\"\nexport * from \"./StatsModal.vue?vue&type=script&lang=js\"\n\nimport \"./StatsModal.vue?vue&type=style&index=0&id=cc5ad82a&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\sande\\\\Documents\\\\GitHub\\\\mvtime.github.io\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-cc5ad82a\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","ref","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_Fragment","_renderList","$data","filters","tag","onClick","$event","active","includes","filter","length","splice","indexOf","push","_normalizeClass","is_ready","key","name","_hoisted_8","_hoisted_9","disabled","can_update","_cache","$options","try_update","loading_bg","surveys","_hoisted_10","_createVNode","_component_apexchart","type","series","graphs","width","height","options","map","survey","data","time","store","theme","_hoisted_11","_hoisted_12","_component_router_link","to","_hoisted_13","_hoisted_14","_ctx","$emit","emits","min_delay","index","range","from","scale","positive","neutral","negative","sentiment","label","charAt","toUpperCase","slice","Math","min","num","tasks","computed","useMainStore","completed","this","active_doc","done_surveys","f","responses","labels","methods","update","_status","log","WarningToast","warn","process","error","forEach","force","last_update","Date","now","get_cached_surveys","then","setTimeout","catch","err","ErrorToast","mounted","created","__exports__","render"],"sourceRoot":""}